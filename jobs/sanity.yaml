- job:
    name: 'sanity'
    description: 'Run sanity tests against Spinal Stack'
    project-type: freestyle
    wrappers:
      - ansicolor:
          colormap: xterm
    builders:
      - shell: |
          set +e
          cp /etc/config-tools/openrc.sh ./smoke/
          cp /etc/config-tools/openrc.sh ./build_tempest/
          ./smoke/smoke-initialize.sh
          ./smoke/smoke-validate.sh
          sudo -i ./build_tempest/setup-tempest.sh
          sudo -i ./build_tempest/configure-tempest.sh -a
          sudo -i ./build_tempest/run-tempest.sh -a -v icehouse -p spinal-stack
          ret=$?
          cp ~/build_tempest/tempest/*tempest_xunit.xml .
          exit $ret
    publishers:
      - junit:
          results: '*tempest_xunit.xml'
